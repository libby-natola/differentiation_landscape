### WGS
### Started 8 June 2021

conda create -n wgs
conda activate wgs
conda install -c bioconda perl-digest-md5
conda install -c bioconda bwa
conda install -c bioconda samtools
conda install -c bioconda gatk
conda install -c bioconda qualimap
conda install -c bioconda vcftools
conda install -c bioconda beagle
conda install -c bioconda gemma
conda install -c bioconda plink

mkdir WGS
cd WGS
mkdir raw_data
mkdir tools
mkdir scripts
mkdir extras
mkdir clean_data_trim

# check hash, save 

md5sum raw_reads/* > raw_reads/hash.md5

# does it look right? should be rows of < 595f44fec1e92a71d3e9e77456ba80d1  filetohashA.txt >

md5sum -c raw_reads/hash.md5

# trimming, make list file of prefixes

cat > extras/prefix.list.wgs.txt
----------
EA22MVZ01
GG13MVZ01
GG13MVZ02
GG13MVZ03
HF14AMN01
HG15MVZ01
IE10S04
IE14S02
IE15S03
IE18S01
IE21S02
IE24S01
IE28S03
IF02S01
IF03S02
IF03S04
IF06S02
IF13S02
IF16S05
IF26RABM01
JD28BBM01
JF14S01
JF25RABM01
JF26RABM01
JF27NBM01
JF30RABM01
JH01NBM01
KD12DMNS01
KD12DMNS02
KE10DMNS01
KE10DMNS02
KE10DMNS03
KE18S02
KE20DMNS01
KE20S02
KE22S01
KE24S01
KE25S03
KE27S02
KF04S01
KF07S01
KF07S03
KF10S01
KF11S02
KF13S01
KF14S03
KF19SO5
KF20S07
KF21S03
KF24RABM01
KG01DMNS01
KG07RABM01
LE29RABM01
LE29RABM02
LE30RABM01
LF22RABM01
MG13RABM01
MG21DMNS01
ND10L01
ND16DMNS01
QD16RABM01
QD21RABM01
QF04DMNS01
QF16DMNS01
RC06BBM01
RC12BBM01
RE03NBM01
RF19DMNS01
SE02RSKM01
TD02BBM01
TF15L03
TF21L01
TF21L02
tG15RABM01
uE23RABM01
uG13RABM01
vF04RABM01
YE19UAM01
----------

# save script to trim in trimmomatic

cat > scripts/trim.pbs
-------------
#!/bin/bash
#script to trim data with trimmomatic

#PBS -l walltime=72:00:00,select=1:ncpus=16:mem=48gb
#PBS -N trim.pbs
#PBS -A st-darreni-1
#PBS -m abe 
#PBS -M natola@zoology.ubc.ca
#PBS -o output.txt
#PBS -e error.txt

cd $PBS_O_WORKDIR

while read prefix

do

java -jar tools/Trimmomatic-0.38/trimmomatic-0.38.jar PE -phred33 -threads 16 -trimlog clean_data_trim/trimlog.txt raw_reads/*"$prefix"_R1.fastq.gz raw_reads/*"$prefix"_R2.fastq.gz clean_data_trim/"$prefix"_R1.fastq.gz clean_data_trim/"$prefix"_R1_unpaired.fastq.gz clean_data_trim/"$prefix"_R2.fastq.gz clean_data_trim/"$prefix"_R2_unpaired.fastq.gz LEADING:3 TRAILING:3 SLIDINGWINDOW:4:15 MINLEN:36

done < extras/prefix.list.wgs.txt
-------------

# submit the job 
qsub scripts/trim.pbs

#######  Align reads to reference and combine single and paired end bam files

# make directories
mkdir sam
mkdir bam
mkdir logs
mkdir ref

# get picard program
cp -r ../pg_gbs/tools/picard-tools-1.97 tools/picard-tools-1.97


## Need to index the reference beforehand for use with bwa and samtools, just transfering from another directory
cp -r ../pg_gbs/ref .
bwa index ref/pseudochromosomes.fa
samtools faidx ref/pseudochromosomes.fa


## align data to reference with bwa in pbs script

cat > scripts/align_wgs.pbs
-----------
#!/bin/bash
#script to align data with bwa
#PBS -l walltime=99:00:00,select=1:ncpus=16:mem=192gb
#PBS -N align_wgs.pbs
#PBS -A st-darreni-1
#PBS -m abe 
#PBS -M natola@zoology.ubc.ca
#PBS -o output.txt
#PBS -e error.txt

# load conda environment
conda init bash
source ~/.bashrc
conda activate align

cd $PBS_O_WORKDIR

# make sure these folders exist
clean_data="clean_data_trim"
sam="sam"

while read prefix
do

## run bwa
bwa mem -t 16 -M ref/pseudochromosomes.fa $clean_data/"$prefix"_R1.fastq.gz $clean_data/"$prefix"_R2.fastq.gz > $sam/"$prefix".sam
bwa mem -t 16 -M ref/pseudochromosomes.fa $clean_data/"$prefix"_R1_unpaired.fastq.gz > $sam/"$prefix".R1.unpaired.sam
bwa mem -t 16 -M ref/pseudochromosomes.fa $clean_data/"$prefix"_R2_unpaired.fastq.gz > $sam/"$prefix".R2.unpaired.sam

done < extras/prefix.list.wgs.txt
-----------

# submit job
qsub scripts/align_wgs.pbs


## add read group headers, convert to bam, sort and index

cat > scripts/picard_wgs.pbs
-----------
#!/bin/bash
#script to add read group headers, convert to bam, sort and index

#PBS -l walltime=99:00:00,select=1:ncpus=1:mem=96gb
#PBS -N picard_wgs.pbs
#PBS -A st-darreni-1
#PBS -m abe 
#PBS -M natola@zoology.ubc.ca
#PBS -o output.txt
#PBS -e error.txt

cd $PBS_O_WORKDIR

# make sure these folders exist
sam="sam"
bam="bam"
lane="wgs"  
runbarcode="wgs" 
log="logs"

# tell it where the executables are
picard="tools/picard-tools-1.97/picard-tools-1.97"

while read prefix
do

## add read group headers, convert to bam, sort and index
java -Xmx2g -jar $picard/AddOrReplaceReadGroups.jar I=$sam/"$prefix".sam O=$bam/"$prefix".bam RGID=$lane RGPL=ILLUMINA RGLB=LIB."$prefix" RGSM="$prefix" RGPU=$runbarcode SORT_ORDER=coordinate CREATE_INDEX=TRUE
java -Xmx2g -jar $picard/AddOrReplaceReadGroups.jar I=$sam/"$prefix".R1.unpaired.sam O=$bam/"$prefix".R1.unpaired.bam RGID=$lane RGPL=ILLUMINA RGLB=LIB."$prefix" RGSM="$prefix" RGPU=$runbarcode SORT_ORDER=coordinate CREATE_INDEX=TRUE
java -Xmx2g -jar $picard/AddOrReplaceReadGroups.jar I=$sam/"$prefix".R2.unpaired.sam O=$bam/"$prefix".R2.unpaired.bam RGID=$lane RGPL=ILLUMINA RGLB=LIB."$prefix" RGSM="$prefix" RGPU=$runbarcode SORT_ORDER=coordinate CREATE_INDEX=TRUE

done < extras/prefix.list.wgs.txt
-----------

qsub scripts/picard_wgs.pbs


### merge se and pe bam files with samtools and index

cat > scripts/merge_index_wgs.pbs
-----------
#!/bin/bash
#script to merge se and pe bam files with samtools and index

#PBS -l walltime=24:00:00,select=1:ncpus=1:mem=192gb
#PBS -N merge_index_wgs.pbs
#PBS -A st-darreni-1
#PBS -m abe 
#PBS -M natola@zoology.ubc.ca
#PBS -o output.txt
#PBS -e error.txt

# load conda environment
conda init bash
source ~/.bashrc
conda activate align

cd $PBS_O_WORKDIR

# make sure these folders exist
bam="bam"

while read prefix
do


## merge se and pe bam files with samtools and index
samtools merge $bam/"$prefix".combo.bam $bam/"$prefix".bam $bam/"$prefix".R1.unpaired.bam $bam/"$prefix".R2.unpaired.bam -f
samtools index $bam/"$prefix".combo.bam

done < extras/prefix.list.wgs.txt
-----------

qsub scripts/merge_index_wgs.pbs




### ASSESS ALIGNMENT TO REFERENCE: QUALIMAP ### Scripts adapted from Aguillon et al. 2021
mkdir qualimap_outputs
mkdir outputs
mkdir errors

qualimap bamqc -bam bam/EA22MVZ01.bam -outfile EA22MVZ01.pdf -outdir qualimap_outputs

### make looped pbs script to run all samples

cat > scripts/qualimap_bamqc.pbs
-----------
#!/bin/bash
#script to run qc on all bam files

#PBS -l walltime=24:00:00,select=1:ncpus=1:mem=5gb
#PBS -N qualimap_bamqc.pbs
#PBS -A st-darreni-1
#PBS -m abe 
#PBS -M natola@zoology.ubc.ca
#PBS -o outputs/qualimap_output.txt
#PBS -e errors/qualimap_error.txt

# load conda environment
conda init bash
source ~/.bashrc
conda activate wgs

cd $PBS_O_WORKDIR

while read prefix
do

qualimap bamqc -bam bam/"$prefix".combo.bam -outfile "$prefix".combo.pdf -outdir qualimap_outputs

done < extras/prefix.list.wgs.txt
-----------

qsub scripts/qualimap_bamqc.pbs

###### mark PCR duplicates, scripts adapted from Aguillon et al. 2021

# make looped pbs script to run all samples

cat > scripts/picard_markduplicates.pbs
-----------
#!/bin/bash
#script to run qc on all bam files

#PBS -l walltime=48:00:00,select=1:ncpus=1:mem=12gb
#PBS -N picard_markduplicates.pbs
#PBS -A st-darreni-1
#PBS -m abe 
#PBS -M natola@zoology.ubc.ca
#PBS -o outputs/picard_markduplicates_output.txt
#PBS -e errors/picard_markduplicates_error.txt

# load conda environment
conda init bash
source ~/.bashrc
conda activate wgs

cd $PBS_O_WORKDIR
# tell it where the executables are
picard="tools/picard-tools-1.97/picard-tools-1.97"

while read prefix
do

java -Xmx2g -jar $picard/MarkDuplicates.jar INPUT=bam/"$prefix".combo.bam OUTPUT=bam/"$prefix".dups_marked.bam METRICS_FILE=bam/"$prefix".dups_marked.metrics.txt MAX_FILE_HANDLES_FOR_READ_ENDS_MAP=1000

done < extras/prefix.list.wgs.txt
-----------

qsub scripts/picard_markduplicates.pbs


#### identify problematic regions, realign, fix mates, scripts adapted from Aguillon et al. 2021. break individuals into groups of 10 for faster analysis

cat > extras/prefix.list.wgs_1to10.txt
----------
EA22MVZ01
GG13MVZ01
GG13MVZ02
GG13MVZ03
HF14AMN01
HG15MVZ01
IE10S04
IE14S02
IE15S03
IE18S01
----------

cat > extras/prefix.list.wgs_11to20.txt
----------
IE21S02
IE24S01
IE28S03
IF02S01
IF03S02
IF03S04
IF06S02
IF13S02
IF16S05
IF26RABM01
----------

cat > extras/prefix.list.wgs_21to30.txt
----------
JD28BBM01
JF14S01
JF25RABM01
JF26RABM01
JF27NBM01
JF30RABM01
JH01NBM01
KD12DMNS01
KD12DMNS02
KE10DMNS01
----------

cat > extras/prefix.list.wgs_31to40.txt
----------
KE10DMNS02
KE10DMNS03
KE18S02
KE20DMNS01
KE20S02
KE22S01
KE24S01
KE25S03
KE27S02
KF04S01
----------

cat > extras/prefix.list.wgs_41to50.txt
----------
KF07S01
KF07S03
KF10S01
KF11S02
KF13S01
KF14S03
KF19SO5
KF20S07
KF21S03
KF24RABM01
----------

cat > extras/prefix.list.wgs_51to60.txt
----------
KG01DMNS01
KG07RABM01
LE29RABM01
LE29RABM02
LE30RABM01
LF22RABM01
MG13RABM01
MG21DMNS01
ND10L01
ND16DMNS01
----------

cat > extras/prefix.list.wgs_61to70.txt
----------
QD16RABM01
QD21RABM01
QF04DMNS01
QF16DMNS01
RC06BBM01
RC12BBM01
RE03NBM01
RF19DMNS01
SE02RSKM01
TD02BBM01
----------

cat > extras/prefix.list.wgs_71to78.txt
----------
TF15L03
TF21L01
TF21L02
tG15RABM01
uE23RABM01
uG13RABM01
vF04RABM01
YE19UAM01
----------


cat > scripts/realign_fixmates.pbs
-----------
#!/bin/bash
#script to run qc on all bam files

#PBS -l walltime=100:00:00,select=1:ncpus=1:mem=24gb
#PBS -N realign_fixmates.pbs
#PBS -A st-darreni-1
#PBS -m abe 
#PBS -M natola@zoology.ubc.ca
#PBS -o outputs/realign_fixmates_output.txt
#PBS -e errors/realign_fixmates_error.txt

# load conda environment
conda init bash
source ~/.bashrc
conda activate wgs

cd $PBS_O_WORKDIR
# tell it where the executables are
picard="tools/picard-tools-1.97/picard-tools-1.97"

while read prefix
do

samtools index bam/"$prefix".dups_marked.bam

GenomeAnalysisTK -T RealignerTargetCreator -R ref/pseudochromosomes.fa -I bam/"$prefix".dups_marked.bam -o bam/"$prefix".realign.intervals

GenomeAnalysisTK -T IndelRealigner -R ref/pseudochromosomes.fa -targetIntervals bam/"$prefix".realign.intervals -I bam/"$prefix".dups_marked.bam -o bam/"$prefix".realigned.bam

java -Xmx2g -jar $picard/FixMateInformation.jar INPUT=bam/"$prefix".realigned.bam OUTPUT=bam/"$prefix".realigned.fixmate.bam SO=coordinate CREATE_INDEX=true 

done < extras/prefix.list.wgs.txt
-----------

qsub scripts/realign_fixmates.pbs


cat > scripts/realign_fixmates_11to20.pbs
-----------
#!/bin/bash
#script to run qc on all bam files

#PBS -l walltime=100:00:00,select=1:ncpus=1:mem=24gb
#PBS -N realign_fixmates_11to20.pbs
#PBS -A st-darreni-1
#PBS -m abe 
#PBS -M natola@zoology.ubc.ca
#PBS -o outputs/realign_fixmates_11to20_output.txt
#PBS -e errors/realign_fixmates_11to20_error.txt

# load conda environment
conda init bash
source ~/.bashrc
conda activate wgs

cd $PBS_O_WORKDIR
# tell it where the executables are
picard="tools/picard-tools-1.97/picard-tools-1.97"

while read prefix
do

samtools index bam/"$prefix".dups_marked.bam

GenomeAnalysisTK -T RealignerTargetCreator -R ref/pseudochromosomes.fa -I bam/"$prefix".dups_marked.bam -o bam/"$prefix".realign.intervals

GenomeAnalysisTK -T IndelRealigner -R ref/pseudochromosomes.fa -targetIntervals bam/"$prefix".realign.intervals -I bam/"$prefix".dups_marked.bam -o bam/"$prefix".realigned.bam

java -Xmx2g -jar $picard/FixMateInformation.jar INPUT=bam/"$prefix".realigned.bam OUTPUT=bam/"$prefix".realigned.fixmate.bam SO=coordinate CREATE_INDEX=true 

done < extras/prefix.list.wgs_11to20.txt
-----------
qsub scripts/realign_fixmates_11to20.pbs


cat > scripts/realign_fixmates_21to30.pbs
-----------
#!/bin/bash
#script to run qc on all bam files

#PBS -l walltime=100:00:00,select=1:ncpus=1:mem=24gb
#PBS -N realign_fixmates_21to30.pbs
#PBS -A st-darreni-1
#PBS -m abe 
#PBS -M natola@zoology.ubc.ca
#PBS -o outputs/realign_fixmates_21to30_output.txt
#PBS -e errors/realign_fixmates_21to30_error.txt

# load conda environment
conda init bash
source ~/.bashrc
conda activate wgs

cd $PBS_O_WORKDIR
# tell it where the executables are
picard="tools/picard-tools-1.97/picard-tools-1.97"

while read prefix
do

samtools index bam/"$prefix".dups_marked.bam

GenomeAnalysisTK -T RealignerTargetCreator -R ref/pseudochromosomes.fa -I bam/"$prefix".dups_marked.bam -o bam/"$prefix".realign.intervals

GenomeAnalysisTK -T IndelRealigner -R ref/pseudochromosomes.fa -targetIntervals bam/"$prefix".realign.intervals -I bam/"$prefix".dups_marked.bam -o bam/"$prefix".realigned.bam

java -Xmx2g -jar $picard/FixMateInformation.jar INPUT=bam/"$prefix".realigned.bam OUTPUT=bam/"$prefix".realigned.fixmate.bam SO=coordinate CREATE_INDEX=true 

done < extras/prefix.list.wgs_21to30.txt
-----------
qsub scripts/realign_fixmates_21to30.pbs


cat > scripts/realign_fixmates_31to40.pbs
-----------
#!/bin/bash
#script to run qc on all bam files

#PBS -l walltime=100:00:00,select=1:ncpus=1:mem=24gb
#PBS -N realign_fixmates_31to40.pbs
#PBS -A st-darreni-1
#PBS -m abe 
#PBS -M natola@zoology.ubc.ca
#PBS -o outputs/realign_fixmates_31to40_output.txt
#PBS -e errors/realign_fixmates_31to40_error.txt

# load conda environment
conda init bash
source ~/.bashrc
conda activate wgs

cd $PBS_O_WORKDIR
# tell it where the executables are
picard="tools/picard-tools-1.97/picard-tools-1.97"

while read prefix
do

samtools index bam/"$prefix".dups_marked.bam

GenomeAnalysisTK -T RealignerTargetCreator -R ref/pseudochromosomes.fa -I bam/"$prefix".dups_marked.bam -o bam/"$prefix".realign.intervals

GenomeAnalysisTK -T IndelRealigner -R ref/pseudochromosomes.fa -targetIntervals bam/"$prefix".realign.intervals -I bam/"$prefix".dups_marked.bam -o bam/"$prefix".realigned.bam

java -Xmx2g -jar $picard/FixMateInformation.jar INPUT=bam/"$prefix".realigned.bam OUTPUT=bam/"$prefix".realigned.fixmate.bam SO=coordinate CREATE_INDEX=true 

done < extras/prefix.list.wgs_31to40.txt
-----------
qsub scripts/realign_fixmates_31to40.pbs


cat > scripts/realign_fixmates_41to50.pbs
-----------
#!/bin/bash
#script to run qc on all bam files

#PBS -l walltime=100:00:00,select=1:ncpus=1:mem=24gb
#PBS -N realign_fixmates_41to50.pbs
#PBS -A st-darreni-1
#PBS -m abe 
#PBS -M natola@zoology.ubc.ca
#PBS -o outputs/realign_fixmates_41to50_output.txt
#PBS -e errors/realign_fixmates_41to50_error.txt

# load conda environment
conda init bash
source ~/.bashrc
conda activate wgs

cd $PBS_O_WORKDIR
# tell it where the executables are
picard="tools/picard-tools-1.97/picard-tools-1.97"

while read prefix
do

samtools index bam/"$prefix".dups_marked.bam

GenomeAnalysisTK -T RealignerTargetCreator -R ref/pseudochromosomes.fa -I bam/"$prefix".dups_marked.bam -o bam/"$prefix".realign.intervals

GenomeAnalysisTK -T IndelRealigner -R ref/pseudochromosomes.fa -targetIntervals bam/"$prefix".realign.intervals -I bam/"$prefix".dups_marked.bam -o bam/"$prefix".realigned.bam

java -Xmx2g -jar $picard/FixMateInformation.jar INPUT=bam/"$prefix".realigned.bam OUTPUT=bam/"$prefix".realigned.fixmate.bam SO=coordinate CREATE_INDEX=true 

done < extras/prefix.list.wgs_41to50.txt
-----------
qsub scripts/realign_fixmates_41to50.pbs


cat > scripts/realign_fixmates_51to60.pbs
-----------
#!/bin/bash
#script to run qc on all bam files

#PBS -l walltime=100:00:00,select=1:ncpus=1:mem=24gb
#PBS -N realign_fixmates.pbs
#PBS -A st-darreni-1
#PBS -m abe 
#PBS -M natola@zoology.ubc.ca
#PBS -o outputs/realign_fixmates_51to60_51to60_51to60_output.txt
#PBS -e errors/realign_fixmates_51to60_51to60_error.txt

# load conda environment
conda init bash
source ~/.bashrc
conda activate wgs

cd $PBS_O_WORKDIR
# tell it where the executables are
picard="tools/picard-tools-1.97/picard-tools-1.97"

while read prefix
do

samtools index bam/"$prefix".dups_marked.bam

GenomeAnalysisTK -T RealignerTargetCreator -R ref/pseudochromosomes.fa -I bam/"$prefix".dups_marked.bam -o bam/"$prefix".realign.intervals

GenomeAnalysisTK -T IndelRealigner -R ref/pseudochromosomes.fa -targetIntervals bam/"$prefix".realign.intervals -I bam/"$prefix".dups_marked.bam -o bam/"$prefix".realigned.bam

java -Xmx2g -jar $picard/FixMateInformation.jar INPUT=bam/"$prefix".realigned.bam OUTPUT=bam/"$prefix".realigned.fixmate.bam SO=coordinate CREATE_INDEX=true 

done < extras/prefix.list.wgs_51to60.txt
-----------
qsub scripts/realign_fixmates_51to60.pbs


cat > scripts/realign_fixmates_61to70.pbs
-----------
#!/bin/bash
#script to run qc on all bam files

#PBS -l walltime=100:00:00,select=1:ncpus=1:mem=24gb
#PBS -N realign_fixmates_61to70.pbs
#PBS -A st-darreni-1
#PBS -m abe 
#PBS -M natola@zoology.ubc.ca
#PBS -o outputs/realign_fixmates_61to70_output.txt
#PBS -e errors/realign_fixmates_61to70_error.txt

# load conda environment
conda init bash
source ~/.bashrc
conda activate wgs

cd $PBS_O_WORKDIR
# tell it where the executables are
picard="tools/picard-tools-1.97/picard-tools-1.97"

while read prefix
do

samtools index bam/"$prefix".dups_marked.bam

GenomeAnalysisTK -T RealignerTargetCreator -R ref/pseudochromosomes.fa -I bam/"$prefix".dups_marked.bam -o bam/"$prefix".realign.intervals

GenomeAnalysisTK -T IndelRealigner -R ref/pseudochromosomes.fa -targetIntervals bam/"$prefix".realign.intervals -I bam/"$prefix".dups_marked.bam -o bam/"$prefix".realigned.bam

java -Xmx2g -jar $picard/FixMateInformation.jar INPUT=bam/"$prefix".realigned.bam OUTPUT=bam/"$prefix".realigned.fixmate.bam SO=coordinate CREATE_INDEX=true 

done < extras/prefix.list.wgs_61to70.txt
-----------
qsub scripts/realign_fixmates_61to70.pbs


cat > scripts/realign_fixmates_71to78.pbs
-----------
#!/bin/bash
#script to run qc on all bam files

#PBS -l walltime=100:00:00,select=1:ncpus=1:mem=24gb
#PBS -N realign_fixmates_71to78.pbs
#PBS -A st-darreni-1
#PBS -m abe 
#PBS -M natola@zoology.ubc.ca
#PBS -o outputs/realign_fixmates_71to78_output.txt
#PBS -e errors/realign_fixmates_71to78_error.txt

# load conda environment
conda init bash
source ~/.bashrc
conda activate wgs

cd $PBS_O_WORKDIR
# tell it where the executables are
picard="tools/picard-tools-1.97/picard-tools-1.97"

while read prefix
do

samtools index bam/"$prefix".dups_marked.bam

GenomeAnalysisTK -T RealignerTargetCreator -R ref/pseudochromosomes.fa -I bam/"$prefix".dups_marked.bam -o bam/"$prefix".realign.intervals

GenomeAnalysisTK -T IndelRealigner -R ref/pseudochromosomes.fa -targetIntervals bam/"$prefix".realign.intervals -I bam/"$prefix".dups_marked.bam -o bam/"$prefix".realigned.bam

java -Xmx2g -jar $picard/FixMateInformation.jar INPUT=bam/"$prefix".realigned.bam OUTPUT=bam/"$prefix".realigned.fixmate.bam SO=coordinate CREATE_INDEX=true 

done < extras/prefix.list.wgs_71to78.txt
-----------
qsub scripts/realign_fixmates_71to78.pbs



cat > scripts/unified_genotyper.pbs
-----------
#!/bin/bash
#variant calling

#PBS -l walltime=125:00:00,select=1:ncpus=40:mem=96gb
#PBS -N unified_genotyper.pbs
#PBS -A st-darreni-1
#PBS -m abe 
#PBS -M natola@zoology.ubc.ca
#PBS -o outputs/unified_genotyper_output.txt
#PBS -e errors/unified_genotyper_error.txt

# load conda environment
conda init bash
source ~/.bashrc
conda activate wgs

cd $PBS_O_WORKDIR

GenomeAnalysisTK -T UnifiedGenotyper -R ref/pseudochromosomes.fa \
-I bam/EA22MVZ01.realigned.fixmate.bam \
-I bam/GG13MVZ01.realigned.fixmate.bam \
-I bam/GG13MVZ02.realigned.fixmate.bam \
-I bam/GG13MVZ03.realigned.fixmate.bam \
-I bam/HF14AMN01.realigned.fixmate.bam \
-I bam/HG15MVZ01.realigned.fixmate.bam \
-I bam/IE10S04.realigned.fixmate.bam \
-I bam/IE14S02.realigned.fixmate.bam \
-I bam/IE15S03.realigned.fixmate.bam \
-I bam/IE18S01.realigned.fixmate.bam \
-I bam/IE21S02.realigned.fixmate.bam \
-I bam/IE24S01.realigned.fixmate.bam \
-I bam/IE28S03.realigned.fixmate.bam \
-I bam/IF02S01.realigned.fixmate.bam \
-I bam/IF03S02.realigned.fixmate.bam \
-I bam/IF03S04.realigned.fixmate.bam \
-I bam/IF06S02.realigned.fixmate.bam \
-I bam/IF13S02.realigned.fixmate.bam \
-I bam/IF16S05.realigned.fixmate.bam \
-I bam/IF26RABM01.realigned.fixmate.bam \
-I bam/JD28BBM01.realigned.fixmate.bam \
-I bam/JF14S01.realigned.fixmate.bam \
-I bam/JF25RABM01.realigned.fixmate.bam \
-I bam/JF26RABM01.realigned.fixmate.bam \
-I bam/JF27NBM01.realigned.fixmate.bam \
-I bam/JF30RABM01.realigned.fixmate.bam \
-I bam/JH01NBM01.realigned.fixmate.bam \
-I bam/KD12DMNS01.realigned.fixmate.bam \
-I bam/KD12DMNS02.realigned.fixmate.bam \
-I bam/KE10DMNS01.realigned.fixmate.bam \
-I bam/KE10DMNS02.realigned.fixmate.bam \
-I bam/KE10DMNS03.realigned.fixmate.bam \
-I bam/KE18S02.realigned.fixmate.bam \
-I bam/KE20DMNS01.realigned.fixmate.bam \
-I bam/KE20S02.realigned.fixmate.bam \
-I bam/KE22S01.realigned.fixmate.bam \
-I bam/KE24S01.realigned.fixmate.bam \
-I bam/KE25S03.realigned.fixmate.bam \
-I bam/KE27S02.realigned.fixmate.bam \
-I bam/KF04S01.realigned.fixmate.bam \
-I bam/KF07S01.realigned.fixmate.bam \
-I bam/KF07S03.realigned.fixmate.bam \
-I bam/KF10S01.realigned.fixmate.bam \
-I bam/KF11S02.realigned.fixmate.bam \
-I bam/KF13S01.realigned.fixmate.bam \
-I bam/KF14S03.realigned.fixmate.bam \
-I bam/KF19SO5.realigned.fixmate.bam \
-I bam/KF20S07.realigned.fixmate.bam \
-I bam/KF21S03.realigned.fixmate.bam \
-I bam/KF24RABM01.realigned.fixmate.bam \
-I bam/KG01DMNS01.realigned.fixmate.bam \
-I bam/KG07RABM01.realigned.fixmate.bam \
-I bam/LE29RABM01.realigned.fixmate.bam \
-I bam/LE29RABM02.realigned.fixmate.bam \
-I bam/LE30RABM01.realigned.fixmate.bam \
-I bam/LF22RABM01.realigned.fixmate.bam \
-I bam/MG13RABM01.realigned.fixmate.bam \
-I bam/MG21DMNS01.realigned.fixmate.bam \
-I bam/ND10L01.realigned.fixmate.bam \
-I bam/ND16DMNS01.realigned.fixmate.bam \
-I bam/QD16RABM01.realigned.fixmate.bam \
-I bam/QD21RABM01.realigned.fixmate.bam \
-I bam/QF04DMNS01.realigned.fixmate.bam \
-I bam/QF16DMNS01.realigned.fixmate.bam \
-I bam/RC06BBM01.realigned.fixmate.bam \
-I bam/RC12BBM01.realigned.fixmate.bam \
-I bam/RE03NBM01.realigned.fixmate.bam \
-I bam/RF19DMNS01.realigned.fixmate.bam \
-I bam/SE02RSKM01.realigned.fixmate.bam \
-I bam/TD02BBM01.realigned.fixmate.bam \
-I bam/TF15L03.realigned.fixmate.bam \
-I bam/TF21L01.realigned.fixmate.bam \
-I bam/TF21L02.realigned.fixmate.bam \
-I bam/tG15RABM01.realigned.fixmate.bam \
-I bam/uE23RABM01.realigned.fixmate.bam \
-I bam/uG13RABM01.realigned.fixmate.bam \
-I bam/vF04RABM01.realigned.fixmate.bam \
-I bam/YE19UAM01.realigned.fixmate.bam \
-nct 40 --sample_ploidy 2 --max_alternate_alleles 3 --output_mode EMIT_VARIANTS_ONLY --genotype_likelihoods_model SNP -o snps/wgs_SNPs.vcf
-----------
qsub scripts/unified_genotyper.pbs



### ASSESS ALIGNMENT OF FIX MATE FASTA: QUALIMAP ###
####################################################

cat > scripts/qualimap_bamqc_fixmates.pbs
-----------
#!/bin/bash
#script to run qc on all bam files
#PBS -l walltime=24:00:00,select=1:ncpus=1:mem=5gb
#PBS -N qualimap_bamqc_fixmates.pbs
#PBS -A st-darreni-1
#PBS -m abe 
#PBS -M natola@zoology.ubc.ca
#PBS -o outputs/qualimap_fixmates_output.txt
#PBS -e errors/qualimap_fixmates_error.txt

# load conda environment
conda init bash
source ~/.bashrc
conda activate wgs

cd $PBS_O_WORKDIR

while read prefix
do

qualimap bamqc -bam bam/"$prefix".realigned.fixmate.bam -outfile "$prefix".realigned.fixmate.pdf -outdir qualimap_outputs

done < extras/prefix.list.wgs.txt
-----------
qsub scripts/qualimap_bamqc_fixmates.pbs


# check bam files are okay 
samtools quickcheck -v bam/*fixmate.bam > bad_bams.fofn   && echo 'all ok' || echo 'some files failed check, see bad_bams.fofn'
* all ok


### remove reads with quality by depth <2, FS = fishers strand > 40 (strand bias), mapping quality less than 20, haplotype score greater than 12

cat > scripts/filtering.pbs
-----------
#!/bin/bash
#variant calling
#PBS -l walltime=100:00:00,select=1:ncpus=1:mem=24gb
#PBS -N filtering.pbs
#PBS -A st-darreni-1
#PBS -m abe 
#PBS -M natola@zoology.ubc.ca
#PBS -o outputs/filtering_output.txt
#PBS -e errors/filtering_error.txt

# load conda environment
conda init bash
source ~/.bashrc
conda activate wgs

cd $PBS_O_WORKDIR


# hard filters QD< 2.0, FS > 40.0, MQ<20.0 (mapping quality) and HaplotypeScore > 12.0
GenomeAnalysisTK -T VariantFiltration -R ref/pseudochromosomes.fa \
-V snps/wgs_SNPs.vcf -o snps/wgs_SNPs_filtered.vcf \
--filterExpression "QD<2.0||FS>40.0||MQ<20.0||HaplotypeScore>12.0" --filterName "first_filter"

# additional filtering
# maximum missing = 20%, MAF = 5%, minimum depth = 3X, maximum depth = 50X, biallelic
vcftools --vcf snps/wgs_SNPs_filtered.vcf --remove-filtered-all --max-missing 0.80 --maf 0.05 --min-meanDP 3 --max-meanDP 50 --min-alleles 2 --max-alleles 2 --recode --out snps/wgs_SNPs_filtered_missing80_mindepth3.vcf

-----------
qsub scripts/filtering.pbs

* After filtering, kept 78 out of 78 Individuals
* After filtering, kept 9983420 out of a possible 39120331 Sites

#remove the two WISA outgroup samples from analysis
vcftools --vcf snps/wgs_SNPs_filtered_missing80_mindepth3.vcf.recode.vcf --remove-indv QF16DMNS01 --remove-indv RF19DMNS01 --recode --out snps/wgs_SNPs_filtered_missing80_mindepth3_nowisa


# calculated summary stats using file calculate_summary_stats.txt
# made PCAS and manhattan plots in HPC R using pca_manhattan.R

##### Go back and get invariant sites for dxy analysis

mkdir gvcf

conda create -n gatk4

#fix fa and index/dict files, gatk doesn't like all the commas
sed 's/,//g' ref/pseudochromosomes.fa > ref/pseudochromosomes.nocommas.fa
gatk CreateSequenceDictionary -R ref/pseudochromosomes.nocommas.fa -O ref/pseudochromosomes.nocommas.dict
samtools faidx ref/pseudochromosomes.nocommas.fa


samtools reheader -c 'sed 's/,//g'' bam/HF14AMN01.realigned.fixmate.bam > bam/HF14AMN01.realigned.fixmate.nocomma.bam
samtools index bam/HF14AMN01.realigned.fixmate.nocomma.bam

while read prefix
do

samtools reheader -c 'sed 's/,//g'' bam/"$prefix".realigned.fixmate.bam > bam/"$prefix".realigned.fixmate.nocomma.bam
samtools index bam/"$prefix".realigned.fixmate.nocomma.bam

done < extras/prefix.list.wgs.txt

samtools reheader -c 'sed 's/,//g'' bam/"$prefix".realigned.fixmate.bam > bam/"$prefix".realigned.fixmate.nocomma.bam

samtools index bam/HF14AMN01.realigned.fixmate.nocomma.bam

fai tig00034305_len=117007_reads=55_class=contig_suggestRepeat=yes_suggestCircular=no
bam tig00034305_len__117007_reads__55_class__contig_suggestRepeat__yes_suggestCircular__no
tig00034305_len__117007_reads__55_class__contig_suggestRepeat__yes_suggestCircular__no
-R ref/pseudochromosomes.nocommas.fa \
-I bam/"$prefix".realigned.fixmate.nocomma.bam \
-ERC GVCF \
-O gvcf/"$prefix".g.vcf.gz

sed 's/=/__/g' ref/pseudochromosomes.nocommas.fa > ref/pseudochromosomes.nocommas.noequals.fa
gatk CreateSequenceDictionary -R ref/pseudochromosomes.nocommas.noequals.fa -O ref/pseudochromosomes.nocommas.noequals.dict
samtools faidx ref/pseudochromosomes.nocommas.noequals.fa


cat > extras/prefix.list.wgs_6to10.txt
----------
HG15MVZ01
IE10S04
IE14S02
IE15S03
IE18S01
----------

cat > extras/prefix.list.wgs_16to20.txt
----------
IF03S04
IF06S02
IF13S02
IF16S05
IF26RABM01
----------

cat > extras/prefix.list.wgs_26to30.txt
----------
JF30RABM01
JH01NBM01
KD12DMNS01
KD12DMNS02
KE10DMNS01
----------

cat > extras/prefix.list.wgs_36to40.txt
----------
KE22S01
KE24S01
KE25S03
KE27S02
KF04S01
----------

cat > extras/prefix.list.wgs_46to50.txt
----------
KF14S03
KF19SO5
KF20S07
KF21S03
KF24RABM01
----------

cat > extras/prefix.list.wgs_56to60.txt
----------
LF22RABM01
MG13RABM01
MG21DMNS01
ND10L01
ND16DMNS01
----------

cat > extras/prefix.list.wgs_66to70.txt
----------
RC12BBM01
RE03NBM01
RF19DMNS01
SE02RSKM01
TD02BBM01
----------

cat > extras/prefix.list.wgs_76to78.txt
----------
uG13RABM01
vF04RABM01
YE19UAM01
----------

cat > extras/prefix.list.wgs_1to5.txt
----------
EA22MVZ01
GG13MVZ01
GG13MVZ02
GG13MVZ03
HF14AMN01
----------


cat > extras/prefix.list.wgs_11to15.txt
----------
IE21S02
IE24S01
IE28S03
IF02S01
IF03S02
----------

cat > extras/prefix.list.wgs_21to25.txt
----------
JD28BBM01
JF14S01
JF25RABM01
JF26RABM01
JF27NBM01
----------

cat > extras/prefix.list.wgs_31to35.txt
----------
KE10DMNS02
KE10DMNS03
KE18S02
KE20DMNS01
KE20S02
----------

cat > extras/prefix.list.wgs_41to45.txt
----------
KF07S01
KF07S03
KF10S01
KF11S02
KF13S01
----------

cat > extras/prefix.list.wgs_51to55.txt
----------
KG01DMNS01
KG07RABM01
LE29RABM01
LE29RABM02
LE30RABM01
----------

cat > extras/prefix.list.wgs_61to65.txt
----------
QD16RABM01
QD21RABM01
QF04DMNS01
QF16DMNS01
RC06BBM01
----------

cat > extras/prefix.list.wgs_71to75.txt
----------
TF15L03
TF21L01
TF21L02
tG15RABM01
uE23RABM01
----------


cat > scripts/unified_genotyper_gvcf_6-10.pbs
-----------
#!/bin/bash
#variant calling
#PBS -l walltime=96:00:00,select=1:ncpus=1:mem=56gb
#PBS -N unified_genotyper_gvcf_6-10.pbs
#PBS -A st-darreni-1
#PBS -m abe 
#PBS -M natola@zoology.ubc.ca
#PBS -o outputs/unified_genotyper_gvcf_6-10_output.txt
#PBS -e errors/unified_genotyper_gvcf_6-10_error.txt

# load conda environment
conda init bash
source ~/.bashrc
conda activate gatk4

cd $PBS_O_WORKDIR

while read prefix
do

gatk --java-options "-Xmx48G" HaplotypeCaller \
-R ref/pseudochromosomes.nocommas.noequals.fa \
-I bam/"$prefix".realigned.fixmate.nocomma.bam \
-ERC GVCF \
-O gvcf/"$prefix".g.vcf.gz


done < extras/prefix.list.wgs_6to10.txt
-----------
qsub scripts/unified_genotyper_gvcf_6-10.pbs

cat > scripts/unified_genotyper_gvcf_16-20.pbs
-----------
#!/bin/bash
#variant calling
#PBS -l walltime=96:00:00,select=1:ncpus=1:mem=56gb
#PBS -N unified_genotyper_gvcf_16-20.pbs
#PBS -A st-darreni-1
#PBS -m abe 
#PBS -M natola@zoology.ubc.ca
#PBS -o outputs/unified_genotyper_gvcf_16-20_output.txt
#PBS -e errors/unified_genotyper_gvcf_16-20_error.txt

# load conda environment
conda init bash
source ~/.bashrc
conda activate gatk4

cd $PBS_O_WORKDIR

while read prefix
do

gatk --java-options "-Xmx48G" HaplotypeCaller \
-R ref/pseudochromosomes.nocommas.noequals.fa \
-I bam/"$prefix".realigned.fixmate.nocomma.bam \
-ERC GVCF \
-O gvcf/"$prefix".g.vcf.gz

done < extras/prefix.list.wgs_16to20.txt
-----------
qsub scripts/unified_genotyper_gvcf_16-20.pbs


cat > scripts/unified_genotyper_gvcf_26-30.pbs
-----------
#!/bin/bash
#variant calling
#PBS -l walltime=96:00:00,select=1:ncpus=1:mem=56gb
#PBS -N unified_genotyper_gvcf_26-30.pbs
#PBS -A st-darreni-1
#PBS -m abe 
#PBS -M natola@zoology.ubc.ca
#PBS -o outputs/unified_genotyper_gvcf_26-30_output.txt
#PBS -e errors/unified_genotyper_gvcf_26-30_error.txt

# load conda environment
conda init bash
source ~/.bashrc
conda activate gatk4

cd $PBS_O_WORKDIR

while read prefix
do

gatk --java-options "-Xmx48G" HaplotypeCaller \
-R ref/pseudochromosomes.nocommas.noequals.fa \
-I bam/"$prefix".realigned.fixmate.nocomma.bam \
-ERC GVCF \
-O gvcf/"$prefix".g.vcf.gz

done < extras/prefix.list.wgs_26to30.txt
-----------
qsub scripts/unified_genotyper_gvcf_26-30.pbs


cat > scripts/unified_genotyper_gvcf_36-40.pbs
-----------
#!/bin/bash
#variant calling
#PBS -l walltime=96:00:00,select=1:ncpus=1:mem=56gb
#PBS -N unified_genotyper_gvcf_36-40.pbs
#PBS -A st-darreni-1
#PBS -m abe 
#PBS -M natola@zoology.ubc.ca
#PBS -o outputs/unified_genotyper_gvcf_36-40_output.txt
#PBS -e errors/unified_genotyper_gvcf_36-40_error.txt

# load conda environment
conda init bash
source ~/.bashrc
conda activate gatk4

cd $PBS_O_WORKDIR

while read prefix
do

gatk --java-options "-Xmx48G" HaplotypeCaller \
-R ref/pseudochromosomes.nocommas.noequals.fa \
-I bam/"$prefix".realigned.fixmate.nocomma.bam \
-ERC GVCF \
-O gvcf/"$prefix".g.vcf.gz

done < extras/prefix.list.wgs_36to40.txt
-----------
qsub scripts/unified_genotyper_gvcf_36-40.pbs



cat > scripts/unified_genotyper_gvcf_46-50.pbs
-----------
#!/bin/bash
#variant calling
#PBS -l walltime=96:00:00,select=1:ncpus=1:mem=56gb
#PBS -N unified_genotyper_gvcf_46-50.pbs
#PBS -A st-darreni-1
#PBS -m abe 
#PBS -M natola@zoology.ubc.ca
#PBS -o outputs/unified_genotyper_gvcf_46-50_output.txt
#PBS -e errors/unified_genotyper_gvcf_46-50_error.txt

# load conda environment
conda init bash
source ~/.bashrc
conda activate gatk4

cd $PBS_O_WORKDIR

while read prefix
do

gatk --java-options "-Xmx48G" HaplotypeCaller \
-R ref/pseudochromosomes.nocommas.noequals.fa \
-I bam/"$prefix".realigned.fixmate.nocomma.bam \
-ERC GVCF \
-O gvcf/"$prefix".g.vcf.gz

done < extras/prefix.list.wgs_46to50.txt
-----------
qsub scripts/unified_genotyper_gvcf_46-50.pbs



cat > scripts/unified_genotyper_gvcf_56-60.pbs
-----------
#!/bin/bash
#variant calling
#PBS -l walltime=96:00:00,select=1:ncpus=1:mem=56gb
#PBS -N unified_genotyper_gvcf_56-60.pbs
#PBS -A st-darreni-1
#PBS -m abe 
#PBS -M natola@zoology.ubc.ca
#PBS -o outputs/unified_genotyper_gvcf_56-60_output.txt
#PBS -e errors/unified_genotyper_gvcf_56-60_error.txt

# load conda environment
conda init bash
source ~/.bashrc
conda activate gatk4

cd $PBS_O_WORKDIR

while read prefix
do

gatk --java-options "-Xmx48G" HaplotypeCaller \
-R ref/pseudochromosomes.nocommas.noequals.fa \
-I bam/"$prefix".realigned.fixmate.nocomma.bam \
-ERC GVCF \
-O gvcf/"$prefix".g.vcf.gz

done < extras/prefix.list.wgs_56to60.txt
-----------
qsub scripts/unified_genotyper_gvcf_56-60.pbs



cat > scripts/unified_genotyper_gvcf_66-70.pbs
-----------
#!/bin/bash
#variant calling
#PBS -l walltime=96:00:00,select=1:ncpus=1:mem=56gb
#PBS -N unified_genotyper_gvcf_66-70.pbs
#PBS -A st-darreni-1
#PBS -m abe 
#PBS -M natola@zoology.ubc.ca
#PBS -o outputs/unified_genotyper_gvcf_66-70_output.txt
#PBS -e errors/unified_genotyper_gvcf_66-70_error.txt

# load conda environment
conda init bash
source ~/.bashrc
conda activate gatk4

cd $PBS_O_WORKDIR

while read prefix
do

gatk --java-options "-Xmx48G" HaplotypeCaller \
-R ref/pseudochromosomes.nocommas.noequals.fa \
-I bam/"$prefix".realigned.fixmate.nocomma.bam \
-ERC GVCF \
-O gvcf/"$prefix".g.vcf.gz

done < extras/prefix.list.wgs_66to70.txt
-----------
qsub scripts/unified_genotyper_gvcf_66-70.pbs




cat > scripts/unified_genotyper_gvcf_76-78.pbs
-----------
#!/bin/bash
#variant calling
#PBS -l walltime=96:00:00,select=1:ncpus=1:mem=56gb
#PBS -N unified_genotyper_gvcf_76-78.pbs
#PBS -A st-darreni-1
#PBS -m abe 
#PBS -M natola@zoology.ubc.ca
#PBS -o outputs/unified_genotyper_gvcf_76-78_output.txt
#PBS -e errors/unified_genotyper_gvcf_76-78_error.txt

# load conda environment
conda init bash
source ~/.bashrc
conda activate gatk4

cd $PBS_O_WORKDIR

while read prefix
do

gatk --java-options "-Xmx48G" HaplotypeCaller \
-R ref/pseudochromosomes.nocommas.noequals.fa \
-I bam/"$prefix".realigned.fixmate.nocomma.bam \
-ERC GVCF \
-O gvcf/"$prefix".g.vcf.gz

done < extras/prefix.list.wgs_76to78.txt
-----------
qsub scripts/unified_genotyper_gvcf_76-78.pbs

cat > scripts/unified_genotyper_gvcf_1-5.pbs
-----------
#!/bin/bash
#variant calling
#PBS -l walltime=96:00:00,select=1:ncpus=1:mem=56gb
#PBS -N unified_genotyper_gvcf_1-5.pbs
#PBS -A st-darreni-1
#PBS -m abe 
#PBS -M natola@zoology.ubc.ca
#PBS -o outputs/unified_genotyper_gvcf_1-5_output.txt
#PBS -e errors/unified_genotyper_gvcf_1-5_error.txt

# load conda environment
conda init bash
source ~/.bashrc
conda activate gatk4

cd $PBS_O_WORKDIR

while read prefix
do

gatk --java-options "-Xmx48G" HaplotypeCaller \
-R ref/pseudochromosomes.nocommas.noequals.fa \
-I bam/"$prefix".realigned.fixmate.nocomma.bam \
-ERC GVCF \
-O gvcf/"$prefix".g.vcf.gz


done < extras/prefix.list.wgs_1to5.txt
-----------
qsub scripts/unified_genotyper_gvcf_1-5.pbs


cat > scripts/unified_genotyper_gvcf_11-15.pbs
-----------
#!/bin/bash
#variant calling
#PBS -l walltime=96:00:00,select=1:ncpus=1:mem=56gb
#PBS -N unified_genotyper_gvcf_11-15.pbs
#PBS -A st-darreni-1
#PBS -m abe 
#PBS -M natola@zoology.ubc.ca
#PBS -o outputs/unified_genotyper_gvcf_11-15_output.txt
#PBS -e errors/unified_genotyper_gvcf_11-15_error.txt

# load conda environment
conda init bash
source ~/.bashrc
conda activate gatk4

cd $PBS_O_WORKDIR

while read prefix
do

gatk --java-options "-Xmx48G" HaplotypeCaller \
-R ref/pseudochromosomes.nocommas.noequals.fa \
-I bam/"$prefix".realigned.fixmate.nocomma.bam \
-ERC GVCF \
-O gvcf/"$prefix".g.vcf.gz

done < extras/prefix.list.wgs_11to15.txt
-----------

qsub scripts/unified_genotyper_gvcf_11-15.pbs


cat > scripts/unified_genotyper_gvcf_21-25.pbs
-----------
#!/bin/bash
#variant calling
#PBS -l walltime=96:00:00,select=1:ncpus=1:mem=56gb
#PBS -N unified_genotyper_gvcf_21-25.pbs
#PBS -A st-darreni-1
#PBS -m abe 
#PBS -M natola@zoology.ubc.ca
#PBS -o outputs/unified_genotyper_gvcf_21-25_output.txt
#PBS -e errors/unified_genotyper_gvcf_21-25_error.txt

# load conda environment
conda init bash
source ~/.bashrc
conda activate gatk4

cd $PBS_O_WORKDIR

while read prefix
do

gatk --java-options "-Xmx48G" HaplotypeCaller \
-R ref/pseudochromosomes.nocommas.noequals.fa \
-I bam/"$prefix".realigned.fixmate.nocomma.bam \
-ERC GVCF \
-O gvcf/"$prefix".g.vcf.gz

done < extras/prefix.list.wgs_21to25.txt
-----------

qsub scripts/unified_genotyper_gvcf_21-25.pbs


cat > scripts/unified_genotyper_gvcf_31-35.pbs
-----------
#!/bin/bash
#variant calling
#PBS -l walltime=96:00:00,select=1:ncpus=1:mem=56gb
#PBS -N unified_genotyper_gvcf_31-35.pbs
#PBS -A st-darreni-1
#PBS -m abe 
#PBS -M natola@zoology.ubc.ca
#PBS -o outputs/unified_genotyper_gvcf_31-35_output.txt
#PBS -e errors/unified_genotyper_gvcf_31-35_error.txt

# load conda environment
conda init bash
source ~/.bashrc
conda activate gatk4

cd $PBS_O_WORKDIR

while read prefix
do

gatk --java-options "-Xmx48G" HaplotypeCaller \
-R ref/pseudochromosomes.nocommas.noequals.fa \
-I bam/"$prefix".realigned.fixmate.nocomma.bam \
-ERC GVCF \
-O gvcf/"$prefix".g.vcf.gz

done < extras/prefix.list.wgs_31to35.txt
-----------

qsub scripts/unified_genotyper_gvcf_31-35.pbs



cat > scripts/unified_genotyper_gvcf_41-45.pbs
-----------
#!/bin/bash
#variant calling
#PBS -l walltime=96:00:00,select=1:ncpus=1:mem=56gb
#PBS -N unified_genotyper_gvcf_41-45.pbs
#PBS -A st-darreni-1
#PBS -m abe 
#PBS -M natola@zoology.ubc.ca
#PBS -o outputs/unified_genotyper_gvcf_41-45_output.txt
#PBS -e errors/unified_genotyper_gvcf_41-45_error.txt

# load conda environment
conda init bash
source ~/.bashrc
conda activate gatk4

cd $PBS_O_WORKDIR

while read prefix
do

gatk --java-options "-Xmx48G" HaplotypeCaller \
-R ref/pseudochromosomes.nocommas.noequals.fa \
-I bam/"$prefix".realigned.fixmate.nocomma.bam \
-ERC GVCF \
-O gvcf/"$prefix".g.vcf.gz

done < extras/prefix.list.wgs_41to45.txt
-----------

qsub scripts/unified_genotyper_gvcf_41-45.pbs



cat > scripts/unified_genotyper_gvcf_51-55.pbs
-----------
#!/bin/bash
#variant calling
#PBS -l walltime=96:00:00,select=1:ncpus=1:mem=56gb
#PBS -N unified_genotyper_gvcf_51-55.pbs
#PBS -A st-darreni-1
#PBS -m abe 
#PBS -M natola@zoology.ubc.ca
#PBS -o outputs/unified_genotyper_gvcf_51-55_output.txt
#PBS -e errors/unified_genotyper_gvcf_51-55_error.txt

# load conda environment
conda init bash
source ~/.bashrc
conda activate gatk4

cd $PBS_O_WORKDIR

while read prefix
do

gatk --java-options "-Xmx48G" HaplotypeCaller \
-R ref/pseudochromosomes.nocommas.noequals.fa \
-I bam/"$prefix".realigned.fixmate.nocomma.bam \
-ERC GVCF \
-O gvcf/"$prefix".g.vcf.gz

done < extras/prefix.list.wgs_51to55.txt
-----------
qsub scripts/unified_genotyper_gvcf_51-55.pbs



cat > scripts/unified_genotyper_gvcf_61-65.pbs
-----------
#!/bin/bash
#variant calling
#PBS -l walltime=96:00:00,select=1:ncpus=1:mem=56gb
#PBS -N unified_genotyper_gvcf_61-65.pbs
#PBS -A st-darreni-1
#PBS -m abe 
#PBS -M natola@zoology.ubc.ca
#PBS -o outputs/unified_genotyper_gvcf_61-65_output.txt
#PBS -e errors/unified_genotyper_gvcf_61-65_error.txt

# load conda environment
conda init bash
source ~/.bashrc
conda activate gatk4

cd $PBS_O_WORKDIR

while read prefix
do

gatk --java-options "-Xmx48G" HaplotypeCaller \
-R ref/pseudochromosomes.nocommas.noequals.fa \
-I bam/"$prefix".realigned.fixmate.nocomma.bam \
-ERC GVCF \
-O gvcf/"$prefix".g.vcf.gz

done < extras/prefix.list.wgs_61to65.txt
-----------
qsub scripts/unified_genotyper_gvcf_61-65.pbs




cat > scripts/unified_genotyper_gvcf_71-75.pbs
-----------
#!/bin/bash
#variant calling
#PBS -l walltime=96:00:00,select=1:ncpus=1:mem=56gb
#PBS -N unified_genotyper_gvcf_71-75.pbs
#PBS -A st-darreni-1
#PBS -m abe 
#PBS -M natola@zoology.ubc.ca
#PBS -o outputs/unified_genotyper_gvcf_71-75_output.txt
#PBS -e errors/unified_genotyper_gvcf_71-75_error.txt

# load conda environment
conda init bash
source ~/.bashrc
conda activate gatk4

cd $PBS_O_WORKDIR

while read prefix
do

gatk --java-options "-Xmx48G" HaplotypeCaller \
-R ref/pseudochromosomes.nocommas.noequals.fa \
-I bam/"$prefix".realigned.fixmate.nocomma.bam \
-ERC GVCF \
-O gvcf/"$prefix".g.vcf.gz

done < extras/prefix.list.wgs_71to75.txt
-----------
qsub scripts/unified_genotyper_gvcf_71-75.pbs




# break them up into multiple separate runs by chromosome
sed 's/,//g' extras/old_names.txt > extras/old_names_nocommas.txt
sed -n '1,5p' extras/old_names_nocommas.txt > extras/old_names_nocommas.1-5.txt
sed -n '6,10p' extras/old_names_nocommas.txt > extras/old_names_nocommas.6-10.txt
sed -n '11,20p' extras/old_names_nocommas.txt > extras/old_names_nocommas.11-20.txt
sed -n '21,35p' extras/old_names_nocommas.txt > extras/old_names_nocommas.21-35.txt
sed -n '36,50p' extras/old_names_nocommas.txt > extras/old_names_nocommas.36-50.txt
sed -n '51,75p' extras/old_names_nocommas.txt > extras/old_names_nocommas.51-75.txt
sed -n '76,100p' extras/old_names_nocommas.txt > extras/old_names_nocommas.76-100.txt
sed -n '101,150p' extras/old_names_nocommas.txt > extras/old_names_nocommas.101-150.txt
sed -n '151,200p' extras/old_names_nocommas.txt > extras/old_names_nocommas.151-200.txt
sed -n '201,269p' extras/old_names_nocommas.txt > extras/old_names_nocommas.201-269.txt

# could not get the DBImport tool to work so I went back to gatk3.8
conda activate wgs


## then i need to filter it again
# remove reads with quality by depth <2, FS = fishers strand > 40 (strand bias), mapping quality less than 20, haplotype score greater than 12

cat > scripts/allSites_filtering_1-5.pbs
-----------
#!/bin/bash
#variant calling
#PBS -l walltime=24:00:00,select=1:ncpus=1:mem=24gb
#PBS -N allSites_filtering_1-5.pbs
#PBS -A st-darreni-1
#PBS -m abe 
#PBS -M natola@zoology.ubc.ca
#PBS -o outputs/allSites_filtering_1-5_output.txt
#PBS -e errors/allSites_filtering_1-5_error.txt

# load conda environment
conda init bash
source ~/.bashrc
conda activate wgs

cd $PBS_O_WORKDIR

while read chrom
do

# hard filters QD< 2.0, FS > 40.0, MQ<20.0 (mapping quality) and HaplotypeScore > 12.0
java -Xmx94g -jar /arc/project/st-darreni-1/tools/miniconda3/envs/wgs/opt/gatk-3.8/GenomeAnalysisTK.jar -T VariantFiltration -R ref/pseudochromosomes.nocommas.noequals.fa \
-V allSites/wgs.genotypes.allSites."$chrom".vcf -o allSites/wgs.genotypes.allSites."$chrom".filtered.vcf \
--filterExpression "QD<2.0||FS>40.0||MQ<20.0||HaplotypeScore>12.0" --filterName "first_filter"

# additional filtering
# maximum missing = 20%, minimum depth = 3X, maximum depth = 50X, biallelic, no MAF or min alleles filters to keep monomorphic sites
vcftools --vcf allSites/wgs.genotypes.allSites."$chrom".filtered.vcf --remove-filtered-all --max-missing 0.80 --min-meanDP 3 --max-meanDP 50 --max-alleles 2 --recode --out allSites/wgs.genotypes.allSites."$chrom".filtered.missing80_mindepth3

bgzip allSites/wgs.genotypes.allSites."$chrom".filtered.missing80_mindepth3.recode.vcf
rm allSites/wgs.genotypes.allSites."$chrom".filtered.vc*
tabix allSites/wgs.genotypes.allSites."$chrom".filtered.missing80_mindepth3.recode.vcf.gz

done < extras/old_names_nocommas.1-5.txt
-----------
qsub scripts/allSites_filtering_1-5.pbs





cat > scripts/allSites_filtering_6-10.pbs
-----------
#!/bin/bash
#variant calling
#PBS -l walltime=24:00:00,select=1:ncpus=1:mem=24gb
#PBS -N allSites_filtering_6-10.pbs
#PBS -A st-darreni-1
#PBS -m abe 
#PBS -M natola@zoology.ubc.ca
#PBS -o outputs/allSites_filtering_6-10_output.txt
#PBS -e errors/allSites_filtering_6-10_error.txt

# load conda environment
conda init bash
source ~/.bashrc
conda activate wgs

cd $PBS_O_WORKDIR

while read chrom
do

# hard filters QD< 2.0, FS > 40.0, MQ<20.0 (mapping quality) and HaplotypeScore > 12.0
java -Xmx94g -jar /arc/project/st-darreni-1/tools/miniconda3/envs/wgs/opt/gatk-3.8/GenomeAnalysisTK.jar -T VariantFiltration -R ref/pseudochromosomes.nocommas.noequals.fa \
-V allSites/wgs.genotypes.allSites."$chrom".vcf -o allSites/wgs.genotypes.allSites."$chrom".filtered.vcf \
--filterExpression "QD<2.0||FS>40.0||MQ<20.0||HaplotypeScore>12.0" --filterName "first_filter"

# additional filtering
# maximum missing = 20%, minimum depth = 3X, maximum depth = 50X, biallelic, no MAF or min alleles filters to keep monomorphic sites
vcftools --vcf allSites/wgs.genotypes.allSites."$chrom".filtered.vcf --remove-filtered-all --max-missing 0.80 --min-meanDP 3 --max-meanDP 50 --max-alleles 2 --recode --out allSites/wgs.genotypes.allSites."$chrom".filtered.missing80_mindepth3

bgzip allSites/wgs.genotypes.allSites."$chrom".filtered.missing80_mindepth3.recode.vcf
rm allSites/wgs.genotypes.allSites."$chrom".filtered.vc*
tabix allSites/wgs.genotypes.allSites."$chrom".filtered.missing80_mindepth3.recode.vcf.gz

done < extras/old_names_nocommas.6-10.txt
-----------
qsub scripts/allSites_filtering_6-10.pbs





cat > scripts/allSites_filtering_11-20.pbs
-----------
#!/bin/bash
#variant calling
#PBS -l walltime=24:00:00,select=1:ncpus=1:mem=24gb
#PBS -N allSites_filtering_11-20.pbs
#PBS -A st-darreni-1
#PBS -m abe 
#PBS -M natola@zoology.ubc.ca
#PBS -o outputs/allSites_filtering_11-20_output.txt
#PBS -e errors/allSites_filtering_11-20_error.txt

# load conda environment
conda init bash
source ~/.bashrc
conda activate wgs

cd $PBS_O_WORKDIR

while read chrom
do

# hard filters QD< 2.0, FS > 40.0, MQ<20.0 (mapping quality) and HaplotypeScore > 12.0
java -Xmx94g -jar /arc/project/st-darreni-1/tools/miniconda3/envs/wgs/opt/gatk-3.8/GenomeAnalysisTK.jar -T VariantFiltration -R ref/pseudochromosomes.nocommas.noequals.fa \
-V allSites/wgs.genotypes.allSites."$chrom".vcf -o allSites/wgs.genotypes.allSites."$chrom".filtered.vcf \
--filterExpression "QD<2.0||FS>40.0||MQ<20.0||HaplotypeScore>12.0" --filterName "first_filter"

# additional filtering
# maximum missing = 20%, minimum depth = 3X, maximum depth = 50X, biallelic, no MAF or min alleles filters to keep monomorphic sites
vcftools --vcf allSites/wgs.genotypes.allSites."$chrom".filtered.vcf --remove-filtered-all --max-missing 0.80 --min-meanDP 3 --max-meanDP 50 --max-alleles 2 --recode --out allSites/wgs.genotypes.allSites."$chrom".filtered.missing80_mindepth3

bgzip allSites/wgs.genotypes.allSites."$chrom".filtered.missing80_mindepth3.recode.vcf
rm allSites/wgs.genotypes.allSites."$chrom".filtered.vc*
tabix allSites/wgs.genotypes.allSites."$chrom".filtered.missing80_mindepth3.recode.vcf.gz

done < extras/old_names_nocommas.11-20.txt
-----------
qsub scripts/allSites_filtering_11-20.pbs





cat > scripts/allSites_filtering_21-35.pbs
-----------
#!/bin/bash
#variant calling
#PBS -l walltime=24:00:00,select=1:ncpus=1:mem=24gb
#PBS -N allSites_filtering_21-35.pbs
#PBS -A st-darreni-1
#PBS -m abe 
#PBS -M natola@zoology.ubc.ca
#PBS -o outputs/allSites_filtering_21-35_output.txt
#PBS -e errors/allSites_filtering_21-35_error.txt

# load conda environment
conda init bash
source ~/.bashrc
conda activate wgs

cd $PBS_O_WORKDIR

while read chrom
do

# hard filters QD< 2.0, FS > 40.0, MQ<20.0 (mapping quality) and HaplotypeScore > 12.0
java -Xmx94g -jar /arc/project/st-darreni-1/tools/miniconda3/envs/wgs/opt/gatk-3.8/GenomeAnalysisTK.jar -T VariantFiltration -R ref/pseudochromosomes.nocommas.noequals.fa \
-V allSites/wgs.genotypes.allSites."$chrom".vcf -o allSites/wgs.genotypes.allSites."$chrom".filtered.vcf \
--filterExpression "QD<2.0||FS>40.0||MQ<20.0||HaplotypeScore>12.0" --filterName "first_filter"

# additional filtering
# maximum missing = 20%, minimum depth = 3X, maximum depth = 50X, biallelic, no MAF or min alleles filters to keep monomorphic sites
vcftools --vcf allSites/wgs.genotypes.allSites."$chrom".filtered.vcf --remove-filtered-all --max-missing 0.80 --min-meanDP 3 --max-meanDP 50 --max-alleles 2 --recode --out allSites/wgs.genotypes.allSites."$chrom".filtered.missing80_mindepth3

bgzip allSites/wgs.genotypes.allSites."$chrom".filtered.missing80_mindepth3.recode.vcf
rm allSites/wgs.genotypes.allSites."$chrom".filtered.vc*
tabix allSites/wgs.genotypes.allSites."$chrom".filtered.missing80_mindepth3.recode.vcf.gz

done < extras/old_names_nocommas.21-35.txt
-----------
qsub scripts/allSites_filtering_21-35.pbs




cat > scripts/allSites_filtering_36-50.pbs
-----------
#!/bin/bash
#variant calling
#PBS -l walltime=24:00:00,select=1:ncpus=1:mem=24gb
#PBS -N allSites_filtering_36-50.pbs
#PBS -A st-darreni-1
#PBS -m abe 
#PBS -M natola@zoology.ubc.ca
#PBS -o outputs/allSites_filtering_36-50_output.txt
#PBS -e errors/allSites_filtering_36-50_error.txt

# load conda environment
conda init bash
source ~/.bashrc
conda activate wgs

cd $PBS_O_WORKDIR

while read chrom
do

# hard filters QD< 2.0, FS > 40.0, MQ<20.0 (mapping quality) and HaplotypeScore > 12.0
java -Xmx94g -jar /arc/project/st-darreni-1/tools/miniconda3/envs/wgs/opt/gatk-3.8/GenomeAnalysisTK.jar -T VariantFiltration -R ref/pseudochromosomes.nocommas.noequals.fa \
-V allSites/wgs.genotypes.allSites."$chrom".vcf -o allSites/wgs.genotypes.allSites."$chrom".filtered.vcf \
--filterExpression "QD<2.0||FS>40.0||MQ<20.0||HaplotypeScore>12.0" --filterName "first_filter"

# additional filtering
# maximum missing = 20%, minimum depth = 3X, maximum depth = 50X, biallelic, no MAF or min alleles filters to keep monomorphic sites
vcftools --vcf allSites/wgs.genotypes.allSites."$chrom".filtered.vcf --remove-filtered-all --max-missing 0.80 --min-meanDP 3 --max-meanDP 50 --max-alleles 2 --recode --out allSites/wgs.genotypes.allSites."$chrom".filtered.missing80_mindepth3

bgzip allSites/wgs.genotypes.allSites."$chrom".filtered.missing80_mindepth3.recode.vcf
rm allSites/wgs.genotypes.allSites."$chrom".filtered.vc*
tabix allSites/wgs.genotypes.allSites."$chrom".filtered.missing80_mindepth3.recode.vcf.gz

done < extras/old_names_nocommas.36-50.txt
-----------
qsub scripts/allSites_filtering_36-50.pbs




cat > scripts/allSites_filtering_51-75.pbs
-----------
#!/bin/bash
#variant calling
#PBS -l walltime=24:00:00,select=1:ncpus=1:mem=24gb
#PBS -N allSites_filtering_51-75.pbs
#PBS -A st-darreni-1
#PBS -m abe 
#PBS -M natola@zoology.ubc.ca
#PBS -o outputs/allSites_filtering_51-75_output.txt
#PBS -e errors/allSites_filtering_51-75_error.txt

# load conda environment
conda init bash
source ~/.bashrc
conda activate wgs

cd $PBS_O_WORKDIR

while read chrom
do

# hard filters QD< 2.0, FS > 40.0, MQ<20.0 (mapping quality) and HaplotypeScore > 12.0
java -Xmx94g -jar /arc/project/st-darreni-1/tools/miniconda3/envs/wgs/opt/gatk-3.8/GenomeAnalysisTK.jar -T VariantFiltration -R ref/pseudochromosomes.nocommas.noequals.fa \
-V allSites/wgs.genotypes.allSites."$chrom".vcf -o allSites/wgs.genotypes.allSites."$chrom".filtered.vcf \
--filterExpression "QD<2.0||FS>40.0||MQ<20.0||HaplotypeScore>12.0" --filterName "first_filter"

# additional filtering
# maximum missing = 20%, minimum depth = 3X, maximum depth = 50X, biallelic, no MAF or min alleles filters to keep monomorphic sites
vcftools --vcf allSites/wgs.genotypes.allSites."$chrom".filtered.vcf --remove-filtered-all --max-missing 0.80 --min-meanDP 3 --max-meanDP 50 --max-alleles 2 --recode --out allSites/wgs.genotypes.allSites."$chrom".filtered.missing80_mindepth3

bgzip allSites/wgs.genotypes.allSites."$chrom".filtered.missing80_mindepth3.recode.vcf
rm allSites/wgs.genotypes.allSites."$chrom".filtered.vc*
tabix allSites/wgs.genotypes.allSites."$chrom".filtered.missing80_mindepth3.recode.vcf.gz

done < extras/old_names_nocommas.51-75.txt
-----------
qsub scripts/allSites_filtering_51-75.pbs




cat > scripts/allSites_filtering_76-269.pbs
-----------
#!/bin/bash
#variant calling
#PBS -l walltime=24:00:00,select=1:ncpus=1:mem=24gb
#PBS -N allSites_filtering_76-269.pbs
#PBS -A st-darreni-1
#PBS -m abe 
#PBS -M natola@zoology.ubc.ca
#PBS -o outputs/allSites_filtering_76-269_output.txt
#PBS -e errors/allSites_filtering_76-269_error.txt

# load conda environment
conda init bash
source ~/.bashrc
conda activate wgs

cd $PBS_O_WORKDIR

while read chrom
do

# hard filters QD< 2.0, FS > 40.0, MQ<20.0 (mapping quality) and HaplotypeScore > 12.0
java -Xmx94g -jar /arc/project/st-darreni-1/tools/miniconda3/envs/wgs/opt/gatk-3.8/GenomeAnalysisTK.jar -T VariantFiltration -R ref/pseudochromosomes.nocommas.noequals.fa \
-V allSites/wgs.genotypes.allSites."$chrom".vcf -o allSites/wgs.genotypes.allSites."$chrom".filtered.vcf \
--filterExpression "QD<2.0||FS>40.0||MQ<20.0||HaplotypeScore>12.0" --filterName "first_filter"

# additional filtering
# maximum missing = 20%, minimum depth = 3X, maximum depth = 50X, biallelic, no MAF or min alleles filters to keep monomorphic sites
vcftools --vcf allSites/wgs.genotypes.allSites."$chrom".filtered.vcf --remove-filtered-all --max-missing 0.80 --min-meanDP 3 --max-meanDP 50 --max-alleles 2 --recode --out allSites/wgs.genotypes.allSites."$chrom".filtered.missing80_mindepth3

bgzip allSites/wgs.genotypes.allSites."$chrom".filtered.missing80_mindepth3.recode.vcf
rm allSites/wgs.genotypes.allSites."$chrom".filtered.vc*
tabix allSites/wgs.genotypes.allSites."$chrom".filtered.missing80_mindepth3.recode.vcf.gz

done < extras/old_names_nocommas.76-269.txt
-----------
qsub scripts/allSites_filtering_76-269.pbs

###### comparing autosomes and Z
### compare FST on autosomes vs Z
# first get autosomes vcf

cat > extras/autosomes.num.txt
----------
1
2
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
31
32
33
34
35
36
37
38
39
40
41
42
43
45
46
49
51
52
53
54
55
57
58
60
61
63
65
67
70
74
75
77
78
83
86
87
88
89
92
96
103
106
107
110
111
112
114
115
118
120
124
125
127
131
132
134
136
139
143
145
149
150
153
157
159
161
163
164
172
173
176
177
181
182
185
186
192
196
200
204
207
214
217
221
226
234
239
240
241
257
258
266
269
273
281
284
298
316
364
365
366
368
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
----------

vcftools --vcf snps/wgs_SNPs_filtered_missing80_mindepth3_nowisa.recode.chroms_renamed_num.vcf \
--chr 1 \
--chr 2 \
--chr 4 \
--chr 5 \
--chr 6 \
--chr 7 \
--chr 8 \
--chr 9 \
--chr 10 \
--chr 11 \
--chr 12 \
--chr 13 \
--chr 14 \
--chr 15 \
--chr 16 \
--chr 17 \
--chr 18 \
--chr 19 \
--chr 20 \
--chr 21 \
--chr 22 \
--chr 23 \
--chr 24 \
--chr 25 \
--chr 26 \
--chr 27 \
--chr 28 \
--chr 29 \
--chr 31 \
--chr 32 \
--chr 33 \
--chr 34 \
--chr 35 \
--chr 36 \
--chr 37 \
--chr 38 \
--chr 39 \
--chr 40 \
--chr 41 \
--chr 42 \
--chr 43 \
--chr 45 \
--chr 46 \
--chr 49 \
--chr 51 \
--chr 52 \
--chr 53 \
--chr 54 \
--chr 55 \
--chr 57 \
--chr 58 \
--chr 60 \
--chr 61 \
--chr 63 \
--chr 65 \
--chr 67 \
--chr 70 \
--chr 74 \
--chr 75 \
--chr 77 \
--chr 78 \
--chr 83 \
--chr 86 \
--chr 87 \
--chr 88 \
--chr 89 \
--chr 92 \
--chr 96 \
--chr 103 \
--chr 106 \
--chr 107 \
--chr 110 \
--chr 111 \
--chr 112 \
--chr 114 \
--chr 115 \
--chr 118 \
--chr 120 \
--chr 124 \
--chr 125 \
--chr 127 \
--chr 131 \
--chr 132 \
--chr 134 \
--chr 136 \
--chr 139 \
--chr 143 \
--chr 145 \
--chr 149 \
--chr 150 \
--chr 153 \
--chr 157 \
--chr 159 \
--chr 161 \
--chr 163 \
--chr 164 \
--chr 172 \
--chr 173 \
--chr 176 \
--chr 177 \
--chr 181 \
--chr 182 \
--chr 185 \
--chr 186 \
--chr 192 \
--chr 196 \
--chr 200 \
--chr 204 \
--chr 207 \
--chr 214 \
--chr 217 \
--chr 221 \
--chr 226 \
--chr 234 \
--chr 239 \
--chr 240 \
--chr 241 \
--chr 257 \
--chr 258 \
--chr 266 \
--chr 269 \
--chr 273 \
--chr 281 \
--chr 284 \
--chr 298 \
--chr 316 \
--chr 364 \
--chr 365 \
--chr 366 \
--chr 368 \
--chr 379 \
--chr 380 \
--chr 381 \
--chr 382 \
--chr 383 \
--chr 384 \
--chr 385 \
--chr 386 \
--chr 387 \
--chr 388 \
--chr 389 \
--chr 390 \
--chr 391 \
--chr 392 \
--chr 393 \
--chr 394 \
--chr 395 \
--chr 396 \
--chr 397 \
--chr 398 \
--chr 399 \
--chr 400 \
--chr 401 \
--chr 402 \
--chr 403 \
--chr 404 \
--chr 405 \
--chr 406 \
--chr 407 \
--chr 408 \
--chr 409 \
--chr 410 \
--chr 411 \
--chr 412 \
--chr 413 \
--chr 414 \
--chr 415 \
--chr 416 \
--chr 417 \
--chr 418 \
--chr 419 \
--chr 420 \
--chr 421 \
--chr 423 \
--chr 424 \
--chr 425 \
--chr 426 \
--chr 427 \
--chr 428 \
--chr 429 \
--chr 430 \
--chr 431 \
--chr 432 \
--chr 433 \
--chr 434 \
--chr 435 \
--chr 436 \
--chr 437 \
--chr 438 \
--chr 439 \
--chr 441 \
--chr 442 \
--chr 443 \
--chr 444 \
--chr 445 \
--chr 446 \
--chr 447 \
--chr 448 \
--chr 449 \
--chr 450 \
--chr 451 \
--chr 452 \
--chr 453 \
--chr 454 \
--chr 455 \
--chr 456 \
--chr 457 \
--chr 458 \
--chr 459 \
--chr 460 \
--chr 461 \
--chr 462 \
--chr 463 \
--chr 464 \
--chr 465 \
--chr 466 \
--chr 467 \
--recode \
--out snps/wgs_SNPs_filtered_missing80_mindepth3_nowisa.recode.chroms_renamed_num.autosomes.vcf
* After filtering, kept 76 out of 76 Individuals
* After filtering, kept 9205747 out of a possible 9983420 Sites

# put allsites and autosome vs Z chromosome summary stats calculation sin calculate_summary_stats.txt

